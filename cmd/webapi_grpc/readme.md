# Phantom gRPC API Server

## Описание

`webapi_grpc` запускает высокопроизводительный gRPC-сервер для взаимодействия с ядром `phantomcore`. gRPC использует Protobuf для определения сервисов и бинарную сериализацию, что делает его значительно быстрее и эффективнее, чем REST/JSON.

## Ключевые возможности

-   **Высокая производительность:** Низкие задержки и малое потребление трафика благодаря бинарному протоколу.
-   **Строгая типизация:** Контракт API определяется в `.proto` файлах, что исключает ошибки несоответствия типов между клиентом и сервером.
-   **Стриминг:** gRPC нативно поддерживает двунаправленный стриминг, что идеально подходит для получения событий в реальном времени (например, новые сообщения, изменения статуса контактов).
-   **Автогенерация клиентов:** Из `.proto` файлов можно автоматически сгенерировать клиентские библиотеки для десятков языков.

## Сборка

```bash
go build -o phantom-grpc-api ./cmd/webapi_grpc
```

## Запуск и использование

```bash
./phantom-grpc-api
# Сервер будет запущен на TCP-порту, указанном в конфигурации, например, :50051
```

Клиенты должны использовать сгенерированный код из `.proto` файла для взаимодействия с сервером.

**Пример API (в `.proto` файле):**

```protobuf
service PhantomController {
    rpc SendMessage(SendMessageRequest) returns (SendMessageResponse);
    rpc GetContacts(GetContactsRequest) returns (GetContactsResponse);
    // Стрим для получения событий в реальном времени
    rpc SubscribeToEvents(EventsRequest) returns (stream Event);
}
```

## Архитектура

Как и REST API, gRPC-сервер может быть как монолитом, так и шлюзом к запущенному `phantomd`. В большинстве случаев, этот gRPC-сервер и есть тот самый API, который предоставляет демон для локального управления (например, для GUI). Предоставление его как отдельного приложения полезно, если вы хотите выставить его в сеть (с TLS и аутентификацией).

## Для кого это?

-   **Разработчики высокопроизводительных систем:** Для интеграции "сервер-сервер" или в архитектуре микросервисов.
-   **Разработчики нативных клиентов (ПК, мобильные):** gRPC является отличной альтернативой FFI или REST для связи между нативным UI и Go-бэкендом.
-   **Проекты, требующие real-time обновлений:** Стриминг в gRPC идеально подходит для создания "живых" интерфейсов.